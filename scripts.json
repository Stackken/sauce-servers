{
  "scripts": {
    "rdpfirewall" : {
      "name": "Open RDP Port",
      "icon": "https://winaero.com/blog/wp-content/uploads/2017/04/remote-desktop-rdp-mstsc-icon.png",
      "description": "Opens the currently selected RDP port on public and private firewall modes",
      "script": [
        "$port = (Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -name \"PortNumber\").PortNumber ; New-NetFirewallRule -DisplayName 'RDPPORT' -Profile 'Public' -Direction Inbound -Action Allow -Protocol TCP -LocalPort $port",
        "$port = (Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -name \"PortNumber\").PortNumber ; New-NetFirewallRule -DisplayName 'RDPPORTPriv' -Profile 'Private' -Direction Inbound -Action Allow -Protocol TCP -LocalPort $port"
      ]
    }
  }
}
